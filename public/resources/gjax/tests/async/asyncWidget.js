/**
 * created 05/02/2013
 * 
 * @author arakovsky
 * 
 * @description unit test for module "gjax/async/AsyncWidget"
 * 
 * @generated by TemplateWizard, v.2012/11/21 //do not remove this comment please
 * @see http://livedocs.dojotoolkit.org/util/doh
 */
define([
	"require",
	"dojo/ready",
	"doh",
	"gjax/async/AsyncWidget",
	"dojo/_base/lang",
	"dojo/dom"
], function(_require, ready, doh, AsyncWidget, lang, dom) {

	var testObject = {
		"Create, place, set" : function() {
			var w = new AsyncWidget("dijit/form/Button", {
				label : "foo"
			});
			w.placeAt("testNode").startup();
			w.set("disabled", true);
			return w.then(function(_w) {
				doh.is("foo", _w.get("label"), "unexpected label");
				doh.is(dom.byId("testNode"), _w.domNode.parentNode, "unexpected parent node");
			});
		},
		"Destroy before resolved" : function() {
			var w = new AsyncWidget("dijit/form/TextBox", {
				label : "foo"
			});
			w.placeAt("testNode").startup();
			w.destroyRecursive();
			return w.then(function() {
				throw new Error("Not expected to be in success callback");
			}, function(e) {
				doh.is("Widget was destroyed", e.message, "unexpected error");
			});
		},
		"Destroy after resolved" : function() {
			var w = new AsyncWidget("dijit/form/Button", {
				label : "foo"
			});
			w.placeAt("testNode").startup();
			return w.then(function() {
				w.destroyRecursive();
				return w;
			})//
			.then(function(_w) {
				doh.t(_w._destroyed, "widget expected to be destroyed");
			});
		},
		"Test context require" : function() {
			var w = new AsyncWidget(_require, "./_async-widget/FooWidget");
			w.placeAt("testNode").startup();
			return w.then(function(_w) {
				doh.is("tstFoo", _w.baseClass, "unexpected property value on widget instance");
			});
		},
		"Test mixins" : function() {
			var w = new AsyncWidget(_require, "./_async-widget/FooWidget", [
				"./_async-widget/_FooMixin"
			]);
			w.placeAt("testNode").startup();
			return w.then(function(_w) {
				doh.t(!!_w.mixinParam, "mixinParam is missing, mixin was not mixed in");
			});
		}
	};

	// --------------------------------------
	doh.register("AsyncWidget", testObject);

	ready(function() {
		doh.run();
	});
});