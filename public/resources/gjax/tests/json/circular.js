/**
 * created 08/12/2014
 * 
 * @author marcus
 * @see http://livedocs.dojotoolkit.org/util/doh
 * @description TODO: fill in description
 * 
 * @generated by TemplateWizard, v.2013/01/03 //do not remove this comment please
 */
define([
	"dojo/has",
	"doh",
//tested libraries
	"dojox/json/ref",
	"gjax/json/cycle",
	"dojo/json"
], function(has, doh, xjson, gjson, json) {

	var a = {};
	var b = {};
	a.b = b;
	b.a = a;

	var testObject = {
		"standard (dojo) serialization will fail on cycle" : function() {
			try {
				json.stringify(a);
				throw new Error("unexpected success");
			} catch (ex) {
				return 1;
			}
		},
		"dojox/json/ref can serialize cycles" : function() {
			// http://dojotoolkit.org/reference-guide/1.9/dojox/json/ref.html
			var s = xjson.toJson(a);
			doh.is('{"b":{"a":{"$ref":"#"}}}', s);
		},
		"gjax/json/cycle.decycle can be used to decycle and then serialize object" : function() {
			var o = gjson.decycle(a);
			var s = json.stringify(o);
			doh.is('{"b":{"a":{"$ref":"$"}}}', s);
		}
	};
	// TODO: auto-generated: rename
	doh.register("json-circular", testObject);

	has("host-browser") || doh.run();
});
