/**
 * created 07/22/2013
 * 
 * @author arakovsky
 * @see http://livedocs.dojotoolkit.org/util/doh
 * @description unit test for module "gjax/mvc/EnhancedStateful"
 * 
 * @generated by TemplateWizard, v.2013/01/03 //do not remove this comment please
 */
define([
	"doh",
	"gjax/mvc/EnhancedStateful",
	"gjax/mvc/ModelRefController"
], function(doh, EnhancedStateful, ModelRefController) {

	//test of handling resolved items is in resolvedEnums.js
	var testObject = {
		"Test nested watch" : function() {
			var testResult = new doh.Deferred(/*canceller*/);
			var modelController = new ModelRefController();
			modelController.loadModelFromData({
				a : {
					b : {
						c : 5
					}
				}
			});
			modelController.watch(function(prop, oldVal, newVal) {
				if (prop == "a.b.c" && newVal == "1") {
					testResult.resolve();
				} else {
					testResult.reject("Unexpected result");
				}
			});
			modelController.model.a.b.set("c", 1);
			return testResult;
		},
		"Test nested watch after change submodel" : function() {
			var testResult = new doh.Deferred(/*canceller*/);
			var modelController = new ModelRefController();
			modelController.loadModelFromData({
				a : {}
			});
			modelController.model.a.set("b", new EnhancedStateful({
				c : 5
			}));
			modelController.watch(function(prop, oldVal, newVal) {
				if (prop == "a.b.c" && newVal == "1") {
					testResult.resolve();
				} else {
					testResult.reject("Unexpected result");
				}
			});
			modelController.model.a.b.set("c", 1);
			return testResult;
		}
	};
	doh.register("gjax/mvc/EnhancedStateful", testObject);

});
