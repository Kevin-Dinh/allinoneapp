/**
 * created 04/22/2013
 * 
 * @author arakovsky
 * 
 * @description unit test for module "gjax/request/jsonRefXhr"
 * 
 * @generated by TemplateWizard, v.2012/11/21 //do not remove this comment please
 * @see http://livedocs.dojotoolkit.org/util/doh
 */
define([
	"require",
	"dojo/ready",
	"doh",
	"gjax/request/jsonRefXhr",
	"gjax/uri/Uri"
], function(require, ready, doh, request, Uri) {

	/*
	 * dojox/json/ref
	 * 
	 * ADVANTAGES:
	 * 	- identifying references ($ref) and replacing for existing instance or loader method (no standard loader, custom impl must be provided)
	 * 	- handling of circular references
	 * 
	 * DISADVANTAGES:
	 * 	- need of usage of ids
	 *  - naive and not always working uri resolving ('../something' works; './something' does not; see pathResolveRegex in ref.js, try to fix it)
	 * 
	 * NOTES:
	 * 	- no mechanism for full loading of an object exists, must be implemented separatly (see sample impl ./jsonXhr)
	 * 	- same index object must be passed to json parser to support referencing (this object is a map ID <-> object; build internally by ref module; used to resolve already loaded references)
	 */

	var testObject = {
		testResolve : testResolve
	};

	function testResolve() {

		var uri = Uri.resolve(null, require.toUrl("./_mockData/sub/a.json"));
		return request(uri)//
		.then(function(a) {
			doh.is("B", a.b.name);
		});

	}

	// --------------------------------------
	doh.register("ref", testObject);

	ready(function() {
		doh.run();
	});
});